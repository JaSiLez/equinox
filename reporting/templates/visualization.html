{% extends "start/generic.html" %}
{% load static %}
{% load custom_tags %}
{% load humanize %}

{% block title %}
    {{ title }} Visualization
{% endblock %}

{% block extrahead %}
    {{ block.super }}
    <script type="text/javascript" charset="utf-8"
            src="{% static 'start/js/vega/vega@4.2.0.js' %}"></script>
    <script type="text/javascript" charset="utf-8" src="{% static 'start/js/vega/vega-lite@3.0.0-rc0.js' %}"></script>
    <script type="text/javascript" charset="utf-8"
            src="{% static 'start/js/vega/vega-embed@3.18.1.js' %}"></script>
{% endblock %}

{% block extrastyle %}
    {{ block.super }}
    <style media="screen">
        .vega-actions a {
            margin-right: 5px;
        }
    </style>

{% endblock %}

{% block messages %}
    <div class="helpblock">
        <p><i class="fa fa-hand-pointer-o"></i> Declarative Visualization: <b>{{ object.name }} :</b>
            <i>{{ object.description }}</i></p>
    </div>
{% endblock %}

{% block breadcrumbs %}
    {% include "reporting/vs_breadcrumb.html" %}
{% endblock %}

{% block content %}

    <div id="page" class="container-non-responsive">


        <div class="row">
            <div class="col-sm-12">
                <div id="vis"></div>
            </div>
        </div>

    </div>

    <script>
        var myData = "{{ portfolio_data | escapejs }}";
        var vlSpec = "{{ visualization_data | escapejs }}";
    </script>

    <script>

        var myData = [
            {"a": "C", "b": 2}, {"a": "C", "b": 7}, {"a": "C", "b": 4},
            {"a": "D", "b": 1}, {"a": "D", "b": 2}, {"a": "D", "b": 6},
            {"a": "E", "b": 8}, {"a": "E", "b": 4}, {"a": "E", "b": 7}
        ];

        var vlSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v3.json",
            "data": {
                "values": [],
                "name": "myData",
            },
            "mark": "bar",
            "encoding": {
                "y": {"field": "a", "type": "nominal"},
                "x": {
                    "aggregate": "average", "field": "b", "type": "quantitative",
                    "axis": {
                        "title": "Average of b"
                    }
                }
            }
        };

        vegaEmbed("#vis", vlSpec)
            .then((res) => res.view
            .renderer('svg')
            .insert("myData", myData)
            .run()
        );

    </script>




{% endblock %}

